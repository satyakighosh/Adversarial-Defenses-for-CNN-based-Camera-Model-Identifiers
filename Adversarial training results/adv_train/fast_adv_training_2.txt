TRYING TO SAVE OPTIMIZER WITH THE MODEL :
----------------------------------------------
    torch.save({
            'epoch': epoch,
            'model_state_dict': best_state_dict,
            'optimizer_state_dict': opt.state_dict(),
            'loss': train_loss/train_n,
            }, os.path.join(args.out_dir, f'model_{epoch}.pth'))



[2022/05/11 12:50:08] - Namespace(alpha=10, batch_size=32, data_dir='./training_data.npy', delta_init='random', early_stop=True, epochs=80, epsilon=8, loss_scale='1.0', lr_max=0.2, lr_min=0.0, lr_schedule='cyclic', master_weights=False, momentum=0.9, opt_level='O2', out_dir='train_fgsm_output', seed=0, weight_decay=0.0005)
[2022/05/11 12:50:10] - Epoch 	 Seconds 	 LR 	 	 Train Loss 	 Train Acc 	 Robust Acc
[2022/05/11 13:06:37] - 0 	 986.6 	 	 0.0050 	 1.6598 	 0.4601 	 0.0312
[2022/05/11 13:23:01] - 1 	 984.3 	 	 0.0100 	 0.9816 	 0.6284 	 0.1250
[2022/05/11 13:39:33] - 2 	 991.8 	 	 0.0150 	 0.7140 	 0.7378 	 0.0938
[2022/05/11 13:51:22] - 3 	 709.1 	 	 0.0200 	 0.6148 	 0.7734 	 0.0312
[2022/05/11 14:01:54] - 4 	 631.7 	 	 0.0250 	 0.5543 	 0.7972 	 0.0938
[2022/05/11 14:12:31] - 5 	 637.1 	 	 0.0300 	 0.6646 	 0.7540 	 0.0625
[2022/05/11 14:23:20] - 6 	 648.8 	 	 0.0350 	 0.6328 	 0.7651 	 0.0938
[2022/05/11 14:33:39] - 7 	 619.4 	 	 0.0400 	 0.7405 	 0.7211 	 0.0000
[2022/05/11 14:44:05] - 8 	 626.3 	 	 0.0450 	 0.8113 	 0.6925 	 0.1250
[2022/05/11 14:54:48] - 9 	 642.8 	 	 0.0500 	 1.0460 	 0.5775 	 0.0312
[2022/05/11 15:08:15] - 10 	 806.7 	 	 0.0550 	 0.8070 	 0.6948 	 0.0625
[2022/05/11 15:20:59] - 11 	 764.3 	 	 0.0600 	 0.7503 	 0.7157 	 0.0312
[2022/05/11 15:33:10] - 12 	 731.0 	 	 0.0650 	 0.7472 	 0.7191 	 0.1562
[2022/05/11 15:43:48] - 13 	 637.4 	 	 0.0700 	 0.7216 	 0.7318 	 0.1562
[2022/05/11 15:57:45] - 14 	 837.7 	 	 0.0750 	 0.8038 	 0.6981 	 0.0938
[2022/05/11 16:11:33] - 15 	 827.4 	 	 0.0800 	 0.8160 	 0.6925 	 0.0000
[2022/05/11 16:27:55] - 16 	 982.6 	 	 0.0850 	 0.9453 	 0.6359 	 0.1875
[2022/05/11 16:49:06] - 17 	 1270.8 	 	 0.0900 	 0.8380 	 0.6798 	 0.0312
[2022/05/11 17:10:22] - 18 	 1275.7 	 	 0.0950 	 0.7832 	 0.7009 	 0.0625
[2022/05/11 17:31:33] - 19 	 1271.1 	 	 0.1000 	 0.7471 	 0.7182 	 0.0625
[2022/05/11 17:52:32] - 20 	 1259.6 	 	 0.1050 	 0.7764 	 0.7083 	 0.1250
[2022/05/11 18:12:22] - 21 	 1189.8 	 	 0.1100 	 0.8417 	 0.6809 	 0.0625
[2022/05/11 18:33:17] - 22 	 1254.6 	 	 0.1150 	 0.8637 	 0.6731 	 0.0312
[2022/05/11 18:54:01] - 23 	 1243.8 	 	 0.1200 	 0.9149 	 0.6518 	 0.0312
[2022/05/11 19:14:56] - 24 	 1255.2 	 	 0.1250 	 0.8698 	 0.6679 	 0.0312
[2022/05/11 19:33:57] - 25 	 1141.5 	 	 0.1300 	 0.6919 	 0.7423 	 0.0938
[2022/05/11 19:49:34] - 26 	 937.1 	 	 0.1350 	 0.8209 	 0.6869 	 0.1250
[2022/05/11 20:05:25] - 27 	 950.7 	 	 0.1400 	 0.8568 	 0.6711 	 0.0000
[2022/05/11 20:21:40] - 28 	 975.3 	 	 0.1450 	 1.2781 	 0.4434 	 0.1250
[2022/05/11 20:40:11] - 29 	 1110.7 	 	 0.1500 	 1.5329 	 0.3130 	 0.1250
[2022/05/11 20:57:31] - 30 	 1039.7 	 	 0.1550 	 1.5773 	 0.2718 	 0.2812
[2022/05/11 21:09:49] - 31 	 738.0 	 	 0.1600 	 1.5819 	 0.2686 	 0.2500
[2022/05/11 21:22:09] - 32 	 739.9 	 	 0.1650 	 1.5836 	 0.2672 	 0.1875
[2022/05/11 21:34:28] - 33 	 739.2 	 	 0.1700 	 1.5824 	 0.2703 	 0.3750
[2022/05/11 21:46:45] - 34 	 737.5 	 	 0.1750 	 1.5841 	 0.2659 	 0.1875
[2022/05/11 21:59:07] - 35 	 741.5 	 	 0.1800 	 1.5820 	 0.2688 	 0.2188
[2022/05/11 22:11:20] - 36 	 733.1 	 	 0.1850 	 1.5801 	 0.2698 	 0.1875
[2022/05/11 22:23:39] - 37 	 738.6 	 	 0.1900 	 1.5850 	 0.2667 	 0.2188
[2022/05/11 22:34:48] - 38 	 669.4 	 	 0.1950 	 1.5845 	 0.2647 	 0.2812
[2022/05/11 22:47:30] - 39 	 761.6 	 	 0.2000 	 1.5835 	 0.2681 	 0.1875
[2022/05/11 23:00:19] - 40 	 769.8 	 	 0.1950 	 1.5853 	 0.2701 	 0.2812
[2022/05/11 23:13:40] - 41 	 800.9 	 	 0.1900 	 1.5846 	 0.2645 	 0.3438
[2022/05/11 23:26:51] - 42 	 790.6 	 	 0.1850 	 1.5852 	 0.2663 	 0.2500
[2022/05/11 23:40:55] - 43 	 843.8 	 	 0.1800 	 1.5830 	 0.2679 	 0.1875
[2022/05/11 23:55:21] - 44 	 866.3 	 	 0.1750 	 1.5832 	 0.2678 	 0.1875
[2022/05/12 00:09:39] - 45 	 858.5 	 	 0.1700 	 1.5812 	 0.2705 	 0.3125
[2022/05/12 00:23:57] - 46 	 858.1 	 	 0.1650 	 1.5788 	 0.2728 	 0.2500
[2022/05/12 00:38:25] - 47 	 867.3 	 	 0.1600 	 1.5767 	 0.2748 	 0.2812
[2022/05/12 00:50:33] - 48 	 728.4 	 	 0.1550 	 1.5769 	 0.2713 	 0.3750
[2022/05/12 01:01:20] - 49 	 647.2 	 	 0.1500 	 1.5792 	 0.2723 	 0.3750
[2022/05/12 01:12:06] - 50 	 645.8 	 	 0.1450 	 1.5773 	 0.2714 	 0.2812
[2022/05/12 01:22:52] - 51 	 645.7 	 	 0.1400 	 1.5766 	 0.2744 	 0.2812
[2022/05/12 01:33:34] - 52 	 641.8 	 	 0.1350 	 1.5775 	 0.2719 	 0.2812
[2022/05/12 01:44:19] - 53 	 644.8 	 	 0.1300 	 1.5793 	 0.2670 	 0.2188
[2022/05/12 01:55:06] - 54 	 647.4 	 	 0.1250 	 1.5743 	 0.2743 	 0.4062
[2022/05/12 02:05:53] - 55 	 646.9 	 	 0.1200 	 1.5738 	 0.2738 	 0.2812
[2022/05/12 02:16:39] - 56 	 645.8 	 	 0.1150 	 1.5700 	 0.2757 	 0.2812
[2022/05/12 02:27:27] - 57 	 648.3 	 	 0.1100 	 1.5709 	 0.2756 	 0.2188
[2022/05/12 02:38:14] - 58 	 647.3 	 	 0.1050 	 1.5674 	 0.2771 	 0.2812
[2022/05/12 02:49:01] - 59 	 646.9 	 	 0.1000 	 1.5614 	 0.2825 	 0.3125
[2022/05/12 02:59:48] - 60 	 646.7 	 	 0.0950 	 1.5622 	 0.2828 	 0.3125
[2022/05/12 03:10:35] - 61 	 647.4 	 	 0.0900 	 1.5604 	 0.2835 	 0.2812
[2022/05/12 03:21:23] - 62 	 647.1 	 	 0.0850 	 1.5571 	 0.2851 	 0.3125
[2022/05/12 03:32:10] - 63 	 647.1 	 	 0.0800 	 1.5579 	 0.2825 	 0.2812
[2022/05/12 03:42:56] - 64 	 646.2 	 	 0.0750 	 1.5578 	 0.2837 	 0.3125
[2022/05/12 03:53:43] - 65 	 647.5 	 	 0.0700 	 1.5522 	 0.2888 	 0.3438
[2022/05/12 04:04:32] - 66 	 648.3 	 	 0.0650 	 1.5476 	 0.2928 	 0.4688
[2022/05/12 04:15:19] - Total train time: 925.1413 minutes
